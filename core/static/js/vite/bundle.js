import{m as F,i as Et,f as Ft,u as It,E as Ae,T as Tt,a as Lt,b as Bt,x as P,c as Ht}from"./assets/vendor-t-ZPRVt5.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();class Nt{constructor(){this.currentRoute=window.location.pathname}async init(){const r=await(await fetch("/routes/?all=1")).json();this.routes=r}navigate(e,r){history.replaceState({html:document.getElementById("main-content").innerHTML},""),history.pushState(null,"",r||e),this.currentRoute=r||e,htmx.swap("#main-content",this.routes[e],{swapStyle:"innerHTML",transition:!0}),window.scrollTo({top:0,behavior:"smooth"}),tt().hide()}}class Wt{constructor(e){this.router=e}dashboard(){this.router.navigate("/dashboard/"),rt.currentType="weekly"}expenditures(){this.router.navigate("/all-expenditures/")}categories(){this.router.navigate("/categories/")}category(e){this.router.navigate("/categories/category-name/",`/categories/${e}/`),document.getElementById("pageHeading").textContent=e}viewWeek(e,r){e!=-1&&(ie("week_id",e),this.router.navigate("viewWeekSkeleton",`/weeks/${e}/`),document.getElementById("pageHeading").textContent=`${r}`)}viewDay(e,r){ie("date",e),ie("seeDay","1"),this.router.navigate("seeDaySkeleton",`/days/${e}/`),document.getElementById("pageHeading").textContent=r}weeks(){this.router.navigate("/weeks/"),document.getElementById("pageHeading").textContent="Weeks"}}const g=new Nt,et=new Wt(g);g.init();window.routes=et;let oe={};const ie=(t,e)=>{oe[t]=e};async function re(t){try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(e){console.log("Error fetching data ",e)}}class At{constructor(){this.subscribers=[]}async fetchLatest(){const e=await re("/api/categories/");this.notifySubscribers(e)}subscribe(e){this.subscribers.push(e)}unsubscribe(e){this.subscribers=this.subscribers.filter(r=>r!=e)}notifySubscribers(e){this.subscribers.forEach(r=>{r.update(e)})}}const H=new At,tt=(()=>{let t;return()=>t||(t=window.FlowbiteInstances._instances.Drawer["separator-sidebar"],t)})();function zt(t){return window.FlowbiteInstances._instances.Dropdown[t]}function Rt(){return decodeURIComponent(window.location.pathname.split("/").filter(t=>t!=="").pop())}function Gt(){const t={...oe};return oe={},/^\/categories\/[^\/]+\/$/.test(g.currentRoute)?{categoryName:Rt(),oneCategory:1,...t}:t}class Vt{constructor(){this.currentType="weekly"}fetch(e){e!=this.currentType&&(this.currentType=e,document.getElementById("statSummary").outerHTML=g.routes["/statSummarySkeleton/"],htmx.ajax("GET","/components/statSummary/?type="+e,{target:"#statSummarySkeleton",swap:"outerHTML"}))}}const rt=new Vt;window.getAdditionalParams=Gt;window.statSummary=rt;window.getDropdown=zt;(function(){let t;document.addEventListener("alpine:init",()=>{F.data("toast",()=>({open:!0,autoDismiss:t,show(){this.autoDismiss&&setTimeout(()=>{this.open=!1},2e3)}}))})})();class jt{constructor(){this.instances={}}getInstance(e){return this.instances[e]}setInstance(e,r){this.instances[e]=r}}const ee=new jt;class Ut{constructor(){this.instances={}}getInstance(e){return this.instances[e]}setInstance(e,r){this.instances[e]=r}}const me=new Ut;(function(){document.addEventListener("alpine:init",()=>{F.data("themeToggler",()=>({dark:localStorage.getItem("dark")=="true",toggle(){this.dark=!this.dark,document.documentElement.classList.toggle("dark",this.dark),localStorage.setItem("dark",this.dark?"true":"false"),document.documentElement.setAttribute("data-theme",this.dark?"dark":"light")}}))})})();class qt{constructor(){this.modals={},this.currentlyOpenModal=null}createModal(e,r){this.modals[e]=r}getModal(e){return this.modals[e]}}const X=new qt;class C{constructor(e){this.modal=X.getModal(e)}open(){this.modal.open()}close(){this.modal.close()}}class Jt extends C{_showPageSkeleton(e){return/^\/categories\/[^\/]+\/$/.test(e)?document.getElementById("see-products").outerHTML=g.routes.seeProductsSkeleton:!(e in g.routes)||e=="/search/"?this._navigateToDashboard():document.getElementById("main-content").innerHTML=g.routes[e]}_getHTMXTarget(e){return/^\/categories\/[^\/]+\/$/.test(e)?"#see-products":e=="/all-expenditures/"?"#all-expenditures":"#main-content"}_navigateToDashboard(){document.getElementById("main-content").innerHTML=g.routes["/dashboard/"],history.pushState(null,"","/dashboard/"),g.currentRoute="/dashboard/"}_resetFormUI(e){e.reset(),ee.getInstance("categories-add-product").select(ee.getInstance("categories-add-product").none),me.getInstance("add-product-date").setToday()}_submitProductForm(e,r){const a=htmx.values(e);htmx.ajax("POST","/implementations/dashboard/",{values:a,target:r}).then(()=>{H.fetchLatest()})}submitForm(){const e=document.getElementById("add-product-form");if(e.checkValidity()){const r=window.location.pathname,a=this._getHTMXTarget(r);this._showPageSkeleton(r),this.close(),this._submitProductForm(e,a),this._resetFormUI(e)}else e.reportValidity()}}class Xt extends C{submitForm(){const e=document.getElementById("add-category-form");if(e.checkValidity()){document.getElementById("main-content").innerHTML=g.routes[g.currentRoute],this.close();const r=htmx.values(e);htmx.ajax("POST","/implementations/categories/",{values:r,target:"#main-content"}).then(()=>{H.fetchLatest()}),e.reset()}else e.reportValidity()}}class Yt extends C{constructor(e,r){super(e),this.ff=r}setDetails(e){const r=JSON.parse(e),a=this.ff.formFields;a.name.value=r.name,a.description.value=r.description?r.description:"",a.id.value=r.id.toString(),this.open()}submitForm(){const e=document.getElementById("edit-category-form");if(e.checkValidity()){document.getElementById("main-content").innerHTML=g.routes[g.currentRoute],this.close();const r=htmx.values(e);htmx.ajax("POST","/implementations/categories/?edit=1",{values:r,target:"#main-content"}).then(()=>{H.fetchLatest()}),e.reset()}else e.reportValidity()}}class Kt extends C{constructor(e,r,a){super(e),this.df=r,this.ff=a}setDetails(e){const r=JSON.parse(e),a=this.df.dataFields,s=this.ff.formFields;a.name.textContent=r.name,s.id.value=r.id.toString(),this.open()}submitForm(){const e=document.getElementById("delete-category-form");document.getElementById("main-content").innerHTML=g.routes[g.currentRoute];const r=htmx.values(e);this.close(),htmx.ajax("POST","/implementations/categories/?delete=1",{values:r,target:"#main-content"}).then(()=>{H.fetchLatest()})}}class ae{constructor(){this.dataFields={}}setDataField(e,r){this.dataFields[e]=r}}class K{constructor(){this.formFields={}}setFormField(e,r){this.formFields[e]=r}}class Qt extends C{constructor(e,r){super(e),this.df=r}setDetails(e){const r=JSON.parse(e),a=this.df.dataFields;a.name.textContent=r.name,a.price.textContent=`GHS ${r.price.toFixed(2)}`,a.category.textContent=r.category?r.category.name:"None",a.description.textContent=r.description||"No description",this.open()}}class Zt extends C{constructor(e,r,a){super(e),this.df=r,this.ff=a}setDetails(e){const r=JSON.parse(e),a=this.df.dataFields,s=this.ff.formFields;a.name.textContent=r.name,a.price.textContent=`GHS ${r.price.toFixed(2)}`,a.category.textContent=r.category?r.category.name:"None",a.description.textContent=r.description||"No description",s.id.value=r.id.toString(),s.date.value=r.date,this.open()}submitForm(){const e=document.getElementById("delete-product-form"),r=htmx.values(e),a=htmx.find(`#product-${r.id}`),s=htmx.closest(a,".record");s.querySelector(".skeleton").classList.remove("hidden"),this.close(),htmx.ajax("POST","/implementations/dashboard/?delete=1",{values:r,target:s,swap:"outerHTML"})}}class er extends C{constructor(e,r){super(e),this.ff=r}setDetails(e){const r=JSON.parse(e),a=this.ff.formFields,s=r.price.toString().split(".");a.name.value=r.name,a.cedis.value=s[0],console.log(s),r.category&&(a.category.value=r.category.id.toString()),s.length==2?a.pesewas.value=s[1].length==2?s[1]:s[1]+"0":a.pesewas.value="00",a.id.value=r.id.toString(),a.description.value=r.description,a.date.value=r.date,this.setCategory(r.category),me.getInstance("edit-product-date").setDate(r.date),this.open()}setCategory(e){const r=ee.getInstance("categories-edit-product");e?r.select(e):r.select({id:null,name:"None"})}submitForm(){const e=document.getElementById("edit-product-form");if(e.checkValidity()){const r=htmx.values(e),a=htmx.find(`#product-${r.id}`),s=htmx.closest(a,".record");s.querySelector(".skeleton").classList.remove("hidden"),this.close(),htmx.ajax("POST","/implementations/dashboard/?edit=1",{values:r,target:s,swap:"outerHTML"}).then(()=>{H.fetchLatest()})}else e.reportValidity()}}class tr extends C{constructor(e,r){super(e),this.df=r}setDetails(e){const r=JSON.parse(e),a=this.df.dataFields;a.name.textContent=r.name,a.product_count.textContent=r.product_count.toString(),a.description.textContent=r.description||"No description",this.open()}}class rr extends C{constructor(e,r){super(e),this.ff=r}async submitForm(){const e=document.getElementById("search-form");if(e.checkValidity()){this.close(),g.navigate("/search/");const r=htmx.values(e);htmx.ajax("GET","/components/search/",{values:r,target:"#main-content"}),e.reset()}else e.reportValidity()}}const ar=(()=>{let t;return()=>{if(t)return t;const e=new K;return t=new rr("search-modal",e),t}})(),sr=(()=>{let t;return()=>t||(t=new Jt("add-product-modal"),t)})(),nr=(()=>{let t;return()=>t||(t=new Xt("add-category-modal"),t)})(),ir=(()=>{let t;return()=>{if(t)return t;const e=new ae,r=new K;return t=new Zt("delete-product-modal",e,r),t}})(),or=(()=>{let t;return()=>{if(t)return t;const e=new ae;return t=new Qt("show-details-modal",e),t}})(),dr=(()=>{let t;return()=>{if(t)return t;const e=new K;return t=new er("edit-product-modal",e),t}})(),cr=(()=>{let t;return()=>{if(t)return t;const e=new ae;return t=new tr("category-details-modal",e),t}})(),lr=(()=>{let t;return()=>{if(t)return t;const e=new ae,r=new K;return t=new Kt("delete-category-modal",e,r),t}})(),ur=(()=>{let t;return()=>{if(t)return t;const e=new K;return t=new Yt("edit-category-modal",e),t}})();function fe(){localStorage.getItem("modalOpen")?(localStorage.removeItem("modalOpen"),localStorage.setItem("forwarded","true"),history.forward()):localStorage.getItem("forwarded")&&X.currentlyOpenModal.close()}window.getAddProductModal=sr;window.getDeleteProductModal=ir;window.getShowDetailsModal=or;window.getEditProductModal=dr;window.getCategoryDetailsModal=cr;window.getAddCategoryModal=nr;window.getDeleteCategoryModal=lr;window.getEditCategoryModal=ur;window.getSearchModal=ar;window.handleCloseModal=fe;window.modalManager=X;class se extends Et{createRenderRoot(){return this}}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const ne=t=>(e,r)=>{r!==void 0?r.addInitializer(()=>{customElements.define(t,e)}):customElements.define(t,e)};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const hr={attribute:!0,type:String,converter:It,reflect:!1,hasChanged:Ft},pr=(t=hr,e,r)=>{const{kind:a,metadata:s}=r;let i=globalThis.litPropertyMetadata.get(s);if(i===void 0&&globalThis.litPropertyMetadata.set(s,i=new Map),a==="setter"&&((t=Object.create(t)).wrapped=!0),i.set(r.name,t),a==="accessor"){const{name:c}=r;return{set(o){const m=e.get.call(this);e.set.call(this,o),this.requestUpdate(c,m,t)},init(o){return o!==void 0&&this.C(c,void 0,t,o),o}}}if(a==="setter"){const{name:c}=r;return function(o){const m=this[c];e.call(this,o),this.requestUpdate(c,m,t)}}throw Error("Unsupported decorator location: "+a)};function x(t){return(e,r)=>typeof r=="object"?pr(t,e,r):((a,s,i)=>{const c=s.hasOwnProperty(i);return s.constructor.createProperty(i,a),c?Object.getOwnPropertyDescriptor(s,i):void 0})(t,e,r)}/**
 * @license lucide v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=([t,e,r])=>{const a=document.createElementNS("http://www.w3.org/2000/svg",t);return Object.keys(e).forEach(s=>{a.setAttribute(s,String(e[s]))}),r?.length&&r.forEach(s=>{const i=at(s);a.appendChild(i)}),a},mr=(t,e={})=>{const r="svg",a={...gr,...e};return at([r,a,t])};/**
 * @license lucide v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fr=[["path",{d:"M12 2v4"}],["path",{d:"m16.2 7.8 2.9-2.9"}],["path",{d:"M18 12h4"}],["path",{d:"m16.2 16.2 2.9 2.9"}],["path",{d:"M12 18v4"}],["path",{d:"m4.9 19.1 2.9-2.9"}],["path",{d:"M2 12h4"}],["path",{d:"m4.9 4.9 2.9 2.9"}]];/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const vr={CHILD:2},yr=t=>(...e)=>({_$litDirective$:t,values:e});class _r{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,r,a){this._$Ct=e,this._$AM=r,this._$Ci=a}_$AS(e,r){return this.update(e,r)}update(e,r){return this.render(...r)}}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class de extends _r{constructor(e){if(super(e),this.it=Ae,e.type!==vr.CHILD)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(e){if(e===Ae||e==null)return this._t=void 0,this.it=e;if(e===Tt)return e;if(typeof e!="string")throw Error(this.constructor.directiveName+"() called with a non-string value");if(e===this.it)return this._t;this.it=e;const r=[e];return r.raw=r,this._t={_$litType$:this.constructor.resultType,strings:r,values:[]}}}de.directiveName="unsafeHTML",de.resultType=1;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class ce extends de{}ce.directiveName="unsafeSVG",ce.resultType=2;const wr=yr(ce);var br=Object.create,ve=Object.defineProperty,xr=Object.getOwnPropertyDescriptor,st=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),N=t=>{throw TypeError(t)},kr=(t,e,r)=>e in t?ve(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ze=(t,e)=>ve(t,"name",{value:e,configurable:!0}),$r=t=>[,,,br(t?.[st("metadata")]??null)],nt=["class","method","getter","setter","accessor","field","value","get","set"],V=t=>t!==void 0&&typeof t!="function"?N("Function expected"):t,Sr=(t,e,r,a,s)=>({kind:nt[t],name:e,metadata:a,addInitializer:i=>r._?N("Already initialized"):s.push(V(i||null))}),Pr=(t,e)=>kr(e,st("metadata"),t[3]),j=(t,e,r,a)=>{for(var s=0,i=t[e>>1],c=i&&i.length;s<c;s++)e&1?i[s].call(r):a=i[s].call(r,a);return a},ye=(t,e,r,a,s,i)=>{var c,o,m,h,f,n=e&7,v=!!(e&8),u=!!(e&16),y=n>3?t.length+1:n?v?1:2:0,k=nt[n+5],$=n>3&&(t[y-1]=[]),E=t[y]||(t[y]=[]),l=n&&(!u&&!v&&(s=s.prototype),n<5&&(n>3||!u)&&xr(n<4?s:{get[r](){return Re(this,i)},set[r](d){return Ve(this,i,d)}},r));n?u&&n<4&&ze(i,(n>2?"set ":n>1?"get ":"")+r):ze(s,r);for(var _=a.length-1;_>=0;_--)h=Sr(n,r,m={},t[3],E),n&&(h.static=v,h.private=u,f=h.access={has:u?d=>Mr(s,d):d=>r in d},n^3&&(f.get=u?d=>(n^1?Re:Or)(d,s,n^4?i:l.get):d=>d[r]),n>2&&(f.set=u?(d,w)=>Ve(d,s,w,n^4?i:l.set):(d,w)=>d[r]=w)),o=(0,a[_])(n?n<4?u?i:l[k]:n>4?void 0:{get:l.get,set:l.set}:s,h),m._=1,n^4||o===void 0?V(o)&&(n>4?$.unshift(o):n?u?i=o:l[k]=o:s=o):typeof o!="object"||o===null?N("Object expected"):(V(c=o.get)&&(l.get=c),V(c=o.set)&&(l.set=c),V(c=o.init)&&$.unshift(c));return n||Pr(t,s),l&&ve(s,r,l),u?n^4?i:l:s},_e=(t,e,r)=>e.has(t)||N("Cannot "+r),Mr=(t,e)=>Object(e)!==e?N('Cannot use the "in" operator on this value'):t.has(e),Re=(t,e,r)=>(_e(t,e,"read from private field"),r?r.call(t):e.get(t)),Ge=(t,e,r)=>e.has(t)?N("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),Ve=(t,e,r,a)=>(_e(t,e,"write to private field"),a?a.call(t,r):e.set(t,r),r),Or=(t,e,r)=>(_e(t,e,"access private method"),r),it,ot,le,dt,O,we,be;const T={data:void 0,useCachedData:!1};dt=[ne("weeks-chart")];class Y extends(le=se,ot=[x({type:Array})],it=[x({type:Boolean})],le){constructor(){super(...arguments),Ge(this,we,j(O,8,this,[])),j(O,11,this),Ge(this,be,j(O,12,this,!1)),j(O,15,this),this.chart=null,this.observer=null}tooltipFormatter(e,{dataPointIndex:r}){return this.data.map(s=>`${s.week_start} - ${s.week_end}`)[r]}getToolTipOptions(){return{theme:this.getisDark()?"dark":"light",style:{fontFamily:"Poppins-Regular"},x:{formatter:this.tooltipFormatter.bind(this)}}}getLabelsStyleOptions(){return{colors:this.getisDark()?"#9ca3af":"#1f2937",fontFamily:"Poppins-Regular"}}getGridOptions(){return{borderColor:this.getisDark()?"#f3f4f60d":"#e5e7eb"}}getisDark(){return document.documentElement.classList.contains("dark")}getXaxisOptions(){return{labels:{style:this.getLabelsStyleOptions()},axisBorder:{color:this.getisDark()?"#f3f4f60d":"#e5e7eb"},axisTicks:{color:this.getisDark()?"#f3f4f60d":"#e5e7eb"}}}getYaxisOptions(){return{labels:{style:this.getLabelsStyleOptions()}}}renderChart(){const e={chart:{type:"line",toolbar:{show:!1},zoom:{enabled:!1}},grid:this.getGridOptions(),stroke:{curve:"smooth",width:1},series:[{name:"Weekly Spendings",data:this.data.map(a=>a.total_amount)}],xaxis:this.getXaxisOptions(),yaxis:this.getYaxisOptions(),tooltip:this.getToolTipOptions()},r=this.querySelector("#chart");r&&(this.chart=new Lt(r,e),this.chart.render())}updateColors(){this.chart&&this.chart.updateOptions({xaxis:this.getXaxisOptions(),yaxis:this.getYaxisOptions(),tooltip:this.getToolTipOptions(),grid:this.getGridOptions()})}async fetchData(){if(T.useCachedData&&T.data)this.data=T.data,T.useCachedData=!1;else{const e=await re("/api/weekly-spendings/?limit=10");this.data=e.weekly_spendings.sort((r,a)=>new Date(r.week_start).getTime()-new Date(a.week_start).getTime()),T.data=this.data}this.chart.updateSeries([{name:"Weekly Spendings",data:this.data.map(e=>e.total_amount)}]),this.ready=!0}firstUpdated(){this.ready=!1,this.renderChart(),this.fetchData(),this.observer=new MutationObserver(()=>{this.updateColors()}),this.observer.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]})}disconnectedCallback(){super.disconnectedCallback(),this.observer&&this.observer.disconnect(),this.chart&&this.chart.destroy()}render(){const e=mr(fr,{color:"#888",size:40,class:"lucide lucide-loader animate-spin stroke-blue-500"}).outerHTML;return P`
    <div style="position:relative;">
        ${this.ready?null:P`
          <div style="
            position:absolute;
            inset:0;
            display:flex;
            align-items:center;
            justify-content:center;
            z-index:10;
          ">
            ${Bt`${wr(e)}`}
          </div>
        `}
        <div id="chart"></div>
    </div>
    `}}O=$r(le);we=new WeakMap;be=new WeakMap;ye(O,4,"data",ot,Y,we);ye(O,4,"ready",it,Y,be);Y=ye(O,0,"WeeksChart",dt,Y);j(O,1,Y);var Cr=Object.create,xe=Object.defineProperty,Dr=Object.getOwnPropertyDescriptor,ct=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),W=t=>{throw TypeError(t)},Er=(t,e,r)=>e in t?xe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,je=(t,e)=>xe(t,"name",{value:e,configurable:!0}),Fr=t=>[,,,Cr(t?.[ct("metadata")]??null)],lt=["class","method","getter","setter","accessor","field","value","get","set"],U=t=>t!==void 0&&typeof t!="function"?W("Function expected"):t,Ir=(t,e,r,a,s)=>({kind:lt[t],name:e,metadata:a,addInitializer:i=>r._?W("Already initialized"):s.push(U(i||null))}),Tr=(t,e)=>Er(e,ct("metadata"),t[3]),M=(t,e,r,a)=>{for(var s=0,i=t[e>>1],c=i&&i.length;s<c;s++)e&1?i[s].call(r):a=i[s].call(r,a);return a},Q=(t,e,r,a,s,i)=>{var c,o,m,h,f,n=e&7,v=!!(e&8),u=!!(e&16),y=n>3?t.length+1:n?v?1:2:0,k=lt[n+5],$=n>3&&(t[y-1]=[]),E=t[y]||(t[y]=[]),l=n&&(!u&&!v&&(s=s.prototype),n<5&&(n>3||!u)&&Dr(n<4?s:{get[r](){return Ue(this,i)},set[r](d){return qe(this,i,d)}},r));n?u&&n<4&&je(i,(n>2?"set ":n>1?"get ":"")+r):je(s,r);for(var _=a.length-1;_>=0;_--)h=Ir(n,r,m={},t[3],E),n&&(h.static=v,h.private=u,f=h.access={has:u?d=>Lr(s,d):d=>r in d},n^3&&(f.get=u?d=>(n^1?Ue:Br)(d,s,n^4?i:l.get):d=>d[r]),n>2&&(f.set=u?(d,w)=>qe(d,s,w,n^4?i:l.set):(d,w)=>d[r]=w)),o=(0,a[_])(n?n<4?u?i:l[k]:n>4?void 0:{get:l.get,set:l.set}:s,h),m._=1,n^4||o===void 0?U(o)&&(n>4?$.unshift(o):n?u?i=o:l[k]=o:s=o):typeof o!="object"||o===null?W("Object expected"):(U(c=o.get)&&(l.get=c),U(c=o.set)&&(l.set=c),U(c=o.init)&&$.unshift(c));return n||Tr(t,s),l&&xe(s,r,l),u?n^4?i:l:s},ke=(t,e,r)=>e.has(t)||W("Cannot "+r),Lr=(t,e)=>Object(e)!==e?W('Cannot use the "in" operator on this value'):t.has(e),Ue=(t,e,r)=>(ke(t,e,"read from private field"),r?r.call(t):e.get(t)),Z=(t,e,r)=>e.has(t)?W("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),qe=(t,e,r,a)=>(ke(t,e,"write to private field"),a?a.call(t,r):e.set(t,r),r),Br=(t,e,r)=>(ke(t,e,"access private method"),r),ut,ht,pt,gt,ue,mt,b,$e,Se,Pe,Me;const L={data:void 0,useCachedData:!1};mt=[ne("weeks-records")];class I extends(ue=se,gt=[x({type:Array})],pt=[x({type:Boolean})],ht=[x({type:Number})],ut=[x({type:Number})],ue){constructor(){super(...arguments),Z(this,$e,M(b,8,this,[])),M(b,11,this),Z(this,Se,M(b,12,this,!1)),M(b,15,this),Z(this,Pe,M(b,16,this,1)),M(b,19,this),Z(this,Me,M(b,20,this,1)),M(b,23,this)}nextPage(){this.currentPage<this.numberOfPages&&(this.ready=!1,this.currentPage++,this.fetchData())}prevPage(){this.currentPage>1&&(this.ready=!1,this.currentPage--,this.fetchData())}getPage(e){e>=1&&e<=this.numberOfPages&&e!==this.currentPage&&(this.ready=!1,this.currentPage=e,this.fetchData())}async fetchData(){if(L.useCachedData&&L.data)this.data=L.data,L.useCachedData=!1;else{const e=await re(`/api/weekly-spendings/?page=${this.currentPage}`);this.data=e.weekly_spendings,this.numberOfPages=e.number_of_pages,this.currentPage=e.current_page,L.data=this.data}this.ready=!0}populateData(e){return e.map(a=>P`
            <tr>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800 dark:text-neutral-200 link" 
                @click=${()=>et.viewWeek(a.id,`${a.week_start} - ${a.week_end}`)}                
                >    
                ${a.week_start} - ${a.week_end}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-800 dark:text-neutral-200">
                    GHS ${a.total_amount}
                </td>
            </tr>
        `)}skeletonRows(e){const r=[];for(let a=0;a<e;a++)r.push(P`
                <tr>
                   <td class="px-6 py-4">
                      <div class="h-4 w-32 record-skeleton"></div>
                    </td>
                   <td class="px-6 py-4">
                      <div class="h-4 w-12 record-skeleton"></div>
                    </td>
                </tr>
            `);return r}connectedCallback(){super.connectedCallback(),this.fetchData()}render(){return P`
        <div class="p-4 bg-gray-50 dark:bg-dark2 dark:border-darkborder rounded-md border relative record">
            <h3 class="p-2  tracking-tight border-b dark:border-darkborder text-gray-900 dark:text-gray-300">
            <div class="flex items-center justify-between">
                <div class="text-xl font-bold">
                <!-- {{date|timesince}} -->
                </div>
            </div>   
            <div class="text-sm text-gray-500 dark:text-gray-400 font-medium my-2">
                <!-- {{ date | dateOnly}} -->
            </div>
            </h3>
        
    <div class="flex flex-col">
        <div class="-m-1.5 overflow-x-auto">
          <div class="p-1.5 min-w-full inline-block align-middle">
            <div class="overflow-hidden">
              <table class="min-w-full divide-y dark:divide-gray-100/5">
                <thead>
                  <tr>
                    <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase">Week</th>
                    <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-gray-500 dark:text-gray-400 uppercase">Total</th>
                  </tr>
                </thead>
                <tbody class="divide-y dark:divide-gray-100/5">
                    ${this.ready?P`${this.populateData(this.data)}`:P`${this.skeletonRows(5)}`}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
    ${P`
      <weeks-records-paginator
      .nextFxn=${this.nextPage.bind(this)}
      .prevFxn=${this.prevPage.bind(this)}
      .getPageFxn=${this.getPage.bind(this)}
      .currentPage=${this.currentPage}
      .numberOfPages=${this.numberOfPages}
      >
      </weeks-records-paginator>`}
    `}}b=Fr(ue);$e=new WeakMap;Se=new WeakMap;Pe=new WeakMap;Me=new WeakMap;Q(b,4,"data",gt,I,$e);Q(b,4,"ready",pt,I,Se);Q(b,4,"currentPage",ht,I,Pe);Q(b,4,"numberOfPages",ut,I,Me);I=Q(b,0,"WeeksRecords",mt,I);M(b,1,I);class Hr{constructor(){this.handlers={}}addHandler(e,r){this.handlers[e]?this.handlers[e].push(r):this.handlers[e]=[r]}handle(e,r){this.handlers[e]&&this.handlers[e].forEach(a=>a()),r.state&&e!="/weeks/"&&(document.getElementById("main-content").innerHTML=r.state.html)}}const Oe=new Hr;Oe.addHandler("/dashboard/",()=>{T.useCachedData=!0});Oe.addHandler("/weeks/",()=>{L.useCachedData=!0,document.getElementById("main-content").innerHTML=g.routes["/weeks/"],document.getElementById("pageHeading").textContent="Weeks"});function Nr(t){return{isOpen:!1,init(){X.createModal(t,this)},open(){this.isOpen=!0,this.toggleSideEffects(!this.isOpen),history.pushState(null,""),localStorage.setItem("modalOpen","true"),X.currentlyOpenModal=this},close(){this.isOpen=!1,this.toggleSideEffects(!this.isOpen),localStorage.removeItem("modalOpen"),localStorage.removeItem("forwarded")},toggleSideEffects(e){const r=document.getElementById("animated-backdrop"),a=document.body;r.classList.toggle("hidden",e),a.classList.toggle("overflow-hidden",!e)},handleClickOutside(e){e.target==e.currentTarget&&this.close()}}}function Wr(t){return{isOpen:!1,filtered:[],items:[],isFocused:!1,selected:{},submitProperty:"",newSearch:"",newCategory:{},none:{id:null,name:"None"},async init(){ee.setInstance(t,this),H.subscribe(this);const e=await re("/api/categories/");this.update(e),this.selected=this.none},update(e){this.items=[this.none,...e],this.filtered=[...this.items]},open(){this.isOpen=!0,this.isFocused=!0},close(){this.isOpen=!1,this.selected={...this.selected},this.filtered=[...this.items],this.isFocused=!1},filter(e){const r=e.currentTarget.value.toLowerCase();this.filtered=this.items.filter(a=>a.name.toLowerCase().includes(r)),this.filtered.length==0?(this.newSearch=e.currentTarget.value,this.newCategory={id:0,name:this.newSearch},this.select(this.newCategory)):this.open()},select(e){this.selected=e,this.isOpen=!1,this.filtered=[...this.items]}}}function Ar(t){return{calendar:void 0,field:void 0,options:{inputMode:!0,positionToInput:"center",styles:{calendar:"calendar",dateBtn:"vc-date__btn date-btn",date:"vc-date",month:"",year:"",yearsYear:"vc-years__year",monthsMonth:"vc-months__month"},onClickDate(e,r){const a=e.context.selectedDates[0];if(a){document.getElementById(t+"-value").value=a;const s=new Date(a);document.getElementById(t).value=s.toDateString()}}},init(){me.setInstance(t,this);const{Calendar:e}=window.VanillaCalendarPro;this.field=document.getElementById(t),this.calendar=new e(this.field,this.options),this.calendar.init(),this.setToday()},setDate(e){const r=new Date(e);this.field.value=r.toDateString();const a=r.toISOString().split("T")[0];document.getElementById(t+"-value").value=a,this.calendar.update()},setToday(){const e=new Date,r=e.toDateString();this.field.value=r,document.getElementById(t+"-value").value=e.toISOString().split("T")[0]}}}function ft(){F.data("baseModal",Nr),F.data("selectField",Wr),F.data("datePicker",Ar)}function Ce(){tt().hide(),window.initFlowbite()}function vt(t){const e=window.location.pathname;e in g.routes&&Oe.handle(e,t),Ce()}document.addEventListener("htmx:afterSettle",Ce);document.addEventListener("alpine:init",ft);window.addEventListener("popstate",fe);window.addEventListener("popstate",vt);window.addEventListener("beforeunload",()=>{document.removeEventListener("alpine:init",ft),window.removeEventListener("popstate",fe),window.removeEventListener("popstate",vt),document.addEventListener("htmx:afterSettle",Ce)});var zr=Object.create,De=Object.defineProperty,Rr=Object.getOwnPropertyDescriptor,yt=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),A=t=>{throw TypeError(t)},Gr=(t,e,r)=>e in t?De(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Je=(t,e)=>De(t,"name",{value:e,configurable:!0}),Vr=t=>[,,,zr(t?.[yt("metadata")]??null)],_t=["class","method","getter","setter","accessor","field","value","get","set"],q=t=>t!==void 0&&typeof t!="function"?A("Function expected"):t,jr=(t,e,r,a,s)=>({kind:_t[t],name:e,metadata:a,addInitializer:i=>r._?A("Already initialized"):s.push(q(i||null))}),Ur=(t,e)=>Gr(e,yt("metadata"),t[3]),he=(t,e,r,a)=>{for(var s=0,i=t[e>>1],c=i&&i.length;s<c;s++)e&1?i[s].call(r):a=i[s].call(r,a);return a},wt=(t,e,r,a,s,i)=>{var c,o,m,h,f,n=e&7,v=!!(e&8),u=!!(e&16),y=n>3?t.length+1:n?v?1:2:0,k=_t[n+5],$=n>3&&(t[y-1]=[]),E=t[y]||(t[y]=[]),l=n&&(!u&&!v&&(s=s.prototype),n<5&&(n>3||!u)&&Rr(n<4?s:{get[r](){return Xe(this,i)},set[r](d){return Ye(this,i,d)}},r));n?u&&n<4&&Je(i,(n>2?"set ":n>1?"get ":"")+r):Je(s,r);for(var _=a.length-1;_>=0;_--)h=jr(n,r,m={},t[3],E),n&&(h.static=v,h.private=u,f=h.access={has:u?d=>qr(s,d):d=>r in d},n^3&&(f.get=u?d=>(n^1?Xe:Xr)(d,s,n^4?i:l.get):d=>d[r]),n>2&&(f.set=u?(d,w)=>Ye(d,s,w,n^4?i:l.set):(d,w)=>d[r]=w)),o=(0,a[_])(n?n<4?u?i:l[k]:n>4?void 0:{get:l.get,set:l.set}:s,h),m._=1,n^4||o===void 0?q(o)&&(n>4?$.unshift(o):n?u?i=o:l[k]=o:s=o):typeof o!="object"||o===null?A("Object expected"):(q(c=o.get)&&(l.get=c),q(c=o.set)&&(l.set=c),q(c=o.init)&&$.unshift(c));return n||Ur(t,s),l&&De(s,r,l),u?n^4?i:l:s},Ee=(t,e,r)=>e.has(t)||A("Cannot "+r),qr=(t,e)=>Object(e)!==e?A('Cannot use the "in" operator on this value'):t.has(e),Xe=(t,e,r)=>(Ee(t,e,"read from private field"),r?r.call(t):e.get(t)),Jr=(t,e,r)=>e.has(t)?A("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),Ye=(t,e,r,a)=>(Ee(t,e,"write to private field"),a?a.call(t,r):e.set(t,r),r),Xr=(t,e,r)=>(Ee(t,e,"access private method"),r),bt,pe,xt,B,Fe;xt=[ne("my-button")];class te extends(pe=se,bt=[x({type:String})],pe){constructor(){super(...arguments),Jr(this,Fe,he(B,8,this,"Click Me")),he(B,11,this)}render(){return P`<button><slot>${this.label}</slot></button>`}}B=Vr(pe);Fe=new WeakMap;wt(B,4,"label",bt,te,Fe);te=wt(B,0,"MyButton",xt,te);he(B,1,te);/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function*Yr(t,e){if(t!==void 0){let r=0;for(const a of t)yield e(a,r++)}}var Kr=Object.create,Ie=Object.defineProperty,Qr=Object.getOwnPropertyDescriptor,kt=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),z=t=>{throw TypeError(t)},Zr=(t,e,r)=>e in t?Ie(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ke=(t,e)=>Ie(t,"name",{value:e,configurable:!0}),ea=t=>[,,,Kr(t?.[kt("metadata")]??null)],$t=["class","method","getter","setter","accessor","field","value","get","set"],J=t=>t!==void 0&&typeof t!="function"?z("Function expected"):t,ta=(t,e,r,a,s)=>({kind:$t[t],name:e,metadata:a,addInitializer:i=>r._?z("Already initialized"):s.push(J(i||null))}),ra=(t,e)=>Zr(e,kt("metadata"),t[3]),S=(t,e,r,a)=>{for(var s=0,i=t[e>>1],c=i&&i.length;s<c;s++)e&1?i[s].call(r):a=i[s].call(r,a);return a},R=(t,e,r,a,s,i)=>{var c,o,m,h,f,n=e&7,v=!!(e&8),u=!!(e&16),y=n>3?t.length+1:n?v?1:2:0,k=$t[n+5],$=n>3&&(t[y-1]=[]),E=t[y]||(t[y]=[]),l=n&&(!u&&!v&&(s=s.prototype),n<5&&(n>3||!u)&&Qr(n<4?s:{get[r](){return Qe(this,i)},set[r](d){return Ze(this,i,d)}},r));n?u&&n<4&&Ke(i,(n>2?"set ":n>1?"get ":"")+r):Ke(s,r);for(var _=a.length-1;_>=0;_--)h=ta(n,r,m={},t[3],E),n&&(h.static=v,h.private=u,f=h.access={has:u?d=>aa(s,d):d=>r in d},n^3&&(f.get=u?d=>(n^1?Qe:sa)(d,s,n^4?i:l.get):d=>d[r]),n>2&&(f.set=u?(d,w)=>Ze(d,s,w,n^4?i:l.set):(d,w)=>d[r]=w)),o=(0,a[_])(n?n<4?u?i:l[k]:n>4?void 0:{get:l.get,set:l.set}:s,h),m._=1,n^4||o===void 0?J(o)&&(n>4?$.unshift(o):n?u?i=o:l[k]=o:s=o):typeof o!="object"||o===null?z("Object expected"):(J(c=o.get)&&(l.get=c),J(c=o.set)&&(l.set=c),J(c=o.init)&&$.unshift(c));return n||ra(t,s),l&&Ie(s,r,l),u?n^4?i:l:s},Te=(t,e,r)=>e.has(t)||z("Cannot "+r),aa=(t,e)=>Object(e)!==e?z('Cannot use the "in" operator on this value'):t.has(e),Qe=(t,e,r)=>(Te(t,e,"read from private field"),r?r.call(t):e.get(t)),G=(t,e,r)=>e.has(t)?z("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),Ze=(t,e,r,a)=>(Te(t,e,"write to private field"),a?a.call(t,r):e.set(t,r),r),sa=(t,e,r)=>(Te(t,e,"access private method"),r),St,Pt,Mt,Ot,Ct,ge,Dt,p,Le,Be,He,Ne,We;Dt=[ne("weeks-records-paginator")];class D extends(ge=se,Ct=[x({type:Number})],Ot=[x({type:Number})],Mt=[x({attribute:!1})],Pt=[x({attribute:!1})],St=[x({attribute:!1})],ge){constructor(){super(...arguments),G(this,Le,S(p,8,this,1)),S(p,11,this),G(this,Be,S(p,12,this,1)),S(p,15,this),G(this,He,S(p,16,this)),S(p,19,this),G(this,Ne,S(p,20,this)),S(p,23,this),G(this,We,S(p,24,this)),S(p,27,this)}renderPageNumbers(){return Yr(Array.from({length:this.numberOfPages},(e,r)=>r+1),e=>P`
        <li>
            <button
                type="button"
                class="flex items-center justify-center px-3 h-8 leading-tight ${this.currentPage===e?"text-blue-600 bg-blue-100 dark:bg-gray-700 dark:text-white":"text-gray-500 bg-white dark:bg-gray-800 dark:text-gray-400"} border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:border-darkborder dark:hover:bg-gray-700 dark:hover:text-white"
                @click=${()=>this.getPageFxn(e)}
            >
                ${e}
            </button>
        </li>
    `)}render(){return P`
    <nav aria-label="Page navigation example" class="flex items-center justify-center p-4">
      <ul class="inline-flex -space-x-px text-sm">
        <li>
          <button
            type="button"
            class="flex items-center justify-center px-3 h-8 ms-0 leading-tight text-gray-500 bg-white border border-e-0 border-gray-300 rounded-s-md hover:bg-gray-100 hover:text-gray-700 dark:bg-dark2 dark:border-darkborder dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white"
            @click=${()=>this.prevPage()}
            ?disabled=${this.currentPage===1}
          >Previous</button>
        </li>
        ${this.renderPageNumbers()}
        <li>
          <button
            type="button"
            class="flex items-center justify-center px-3 h-8 leading-tight text-gray-500 bg-white border border-gray-300 rounded-e-md hover:bg-gray-100 hover:text-gray-700 dark:bg-dark2 dark:border-darkborder dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white"
            @click=${()=>this.nextPage()}
            ?disabled=${this.currentPage===this.numberOfPages}
          >Next</button>
        </li>
      </ul>
    </nav>
    `}prevPage(){this.prevFxn()}nextPage(){this.nextFxn()}getPage(e){this.getPageFxn(e)}}p=ea(ge);Le=new WeakMap;Be=new WeakMap;He=new WeakMap;Ne=new WeakMap;We=new WeakMap;R(p,4,"currentPage",Ct,D,Le);R(p,4,"numberOfPages",Ot,D,Be);R(p,4,"nextFxn",Mt,D,He);R(p,4,"prevFxn",Pt,D,Ne);R(p,4,"getPageFxn",St,D,We);D=R(p,0,"WeeksRecordsPaginator",Dt,D);S(p,1,D);window.Alpine=F;document.addEventListener("DOMContentLoaded",()=>{Ht(),F.start()});
